# Root Environment Example (milo-token)
# Copy to .env and fill values as needed.

# --- Core Network ---
CLUSTER=devnet

# Workload-specific RPC pools (comma-separated, highest priority first)
PUBLISHER_RPC_URLS=https://api.devnet.solana.com
AGGREGATOR_RPC_URLS=https://api.devnet.solana.com
GATEWAY_RPC_URLS=https://api.devnet.solana.com

# Legacy single RPC fallback (used by older scripts; optional)
# RPC_URL=https://api.devnet.solana.com

# --- Program Selection ---
# Default to MILO_OPEN for devnet testing
PROGRAM_ID=6DoHCzhmWGDYCvPoADqNfRD8kgVex226LtmUH26v1cLX
PROGRAM_FLAVOR=MILO_OPEN
# For MILO_OPEN PDA derivation, set MINT_PUBKEY or provide via query param
MINT_PUBKEY=

# --- TWZRD (compat; legacy read paths) ---
REWARD_MINT=FHFCPLierqNwqMkATmnCbT2ZPnnQ9j1AWWydKAUEB6Cj
TWZRD_MINT=

# --- MILO (Token-2022) ---
MILO_PROGRAM_ID=
MILO_MINT=
MILO_TREASURY=

# --- Gateway (Fastify) ---
NODE_ENV=production
PORT=8080
ALLOWED_ORIGINS=http://localhost:3000,https://twzrd.xyz,https://api.twzrd.xyz
JWT_SECRET=change_me_32_bytes_minimum________________________________
COOKIE_SECRET=change_me_cookie_secret_32_bytes_min____________________

# Twitch OAuth (for login flows)
TWITCH_CLIENT_ID=
TWITCH_CLIENT_SECRET=
TWITCH_REDIRECT_URI=https://twzrd.xyz/oauth/twitch/callback

# CAPTCHA (Cloudflare Turnstile)
TURNSTILE_SITE_KEY=
TURNSTILE_SECRET_KEY=

# Gateway feature flags (default off to reduce surface area)
ENABLE_CREATOR_MOCK=false
ENABLE_DISTRIBUTOR=false
ENABLE_LIVE_ROUTES=false
ENABLE_TWITCH_WEBHOOKS=false

# Proof hosting / salt
PROOF_BASE_URL=
PROOF_SALT=

# --- Aggregator ---
EPOCH_SECONDS=3600
DB_PATH=./data/aggregator.db
PAYER_KEYPAIR=./keys/publisher.json
MILO2022_PROGRAM=6DoHCzhmWGDYCvPoADqNfRD8kgVex226LtmUH26v1cLX
MINT_PUBKEY=
ENABLE_AUTO_PUBLISH=false
AUTO_FINALIZE=false

# --- Worker v2 ---
CHANNELS_FILE=./data/channels/top-222.txt
TOTAL_SHARDS=1
SHARD_INDEX=0
HEALTH_PORT=9999

# --- Portal (build-time; see apps/portal-v2/.env.production for production) ---
# VITE_API_URL=https://api.twzrd.xyz
# VITE_PROGRAM_ID=...
# VITE_TOKEN_MINT=...
# VITE_TOKEN_DECIMALS=6
# VITE_TURNSTILE_SITE_KEY=...

# --- Publisher script guardrails ---
MAINNET_PUBLISH=false
REQUIRE_APPROVAL=true
MIN_BALANCE_SOL=0.5
GO_FILE=GO.MAINNET

# --- Security Hardening / Sybil / RPC (optional) ---
# Emergency pause (halts ingest/finalize in aggregator)
EMERGENCY_PAUSE=false

# L2 bot exclusion (claim trees exclude bots DB + known-hash list)
EXCLUDE_BOTS_IN_L2=true

# RPC fallback pool (comma separated). Primary still uses RPC_URL
# RPC_URLS=https://rpc1.example.com,https://rpc2.example.com
RPC_TIMEOUT_MS=10000

# Aggregator behavior analyzer
SYBIL_MAX_CHANNELS_PER_EPOCH=2
SYBIL_MAX_SIGNALS_PER_EPOCH=60
SYBIL_MIN_SESSION_MINUTES=1
SYBIL_SUSPECT_WEIGHT_FACTOR=0.2
SYBIL_BEHAVIOR_FLAG_TO_BOT=false

# Worker v2 sybil
SYBIL_WINDOW_MS=60000
SYBIL_MAX_MPM=20
SYBIL_MIN_UNIQUE_RATIO=0.3
SYBIL_MIN_SESSION_SECONDS=60
SYBIL_PATTERN_WINDOW=20
SYBIL_ENABLE_ML=false

# Drip monitor safeguards
DRIP_REQUIRE_SAFETY=false
PRICE_MAX_MOVE_1H=20
TREASURY_MIN_SOL=2
MIN_TRADES_1H=10
MIN_LIQ_USD=2500
