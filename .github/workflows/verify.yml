name: Verify Program
on:
  workflow_dispatch: {}
  push:
    branches: [ upgrade/** ]
jobs:
  verify:
    runs-on: ubuntu-24.04
    container:
      image: solanafoundation/anchor:v0.32.1
    env:
      PROGRAM_ID: GnGzNdsQMxMpJfMeqnkGPsvHm8kwaDidiKjNU2dCVZop
    steps:
      - uses: actions/checkout@v4
      - name: Show versions
        run: |
          anchor --version
          solana --version || true
      - name: Verify on-chain program matches this source
        working-directory: programs/token_2022
        run: |
          anchor verify "$PROGRAM_ID" --provider.cluster mainnet --current-dir
